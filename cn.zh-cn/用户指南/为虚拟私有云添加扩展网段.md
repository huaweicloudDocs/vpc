# 为虚拟私有云添加扩展网段<a name="vpc_vpc_0007"></a>

## 操作场景<a name="zh-cn_topic_0286956167_section15874124165815"></a>

VPC创建后，若主网段不够分配时，您可以通过添加扩展网段来扩充VPC的网段。

创建VPC时配置的IPv4网段是VPC的主网段。VPC创建后，主网段不能进行修改，但您可以添加IPv4扩展网段来扩充VPC的网段。

添加扩展网段后，您可以选择使用主网段或扩展网段来创建子网，但每个子网只能属于一个VPC网段。同主网段一样，使用扩展网段创建子网时，系统也会在VPC路由表中自动添加一条子网路由。

>![](public_sys-resources/icon-note.gif) **说明：** 
>-   添加IPv4扩展网段功能目前仅在“华北-北京一”、“华北-北京四”、“华北-乌兰察布一”、“华东-上海一”、“华东-上海二”、“华南-广州”、“西南-贵阳一”、“中国-香港”、“亚太-新加坡”、“拉美-墨西哥城一”、“拉美-圣保罗一”、“拉美-圣地亚哥”开放。
>-   添加IPv4扩展网段功能上线后，将不再支持修改原有的VPC网段。您可以通过API接口修改原有的VPC网段，具体请参见[《虚拟私有云API参考》](https://support.huaweicloud.com/api-vpc/vpc_api01_0004.html)。

## 前提条件<a name="zh-cn_topic_0286956167_section1459232459"></a>

已创建VPC。

## 约束与限制<a name="zh-cn_topic_0286956167_section5667204411244"></a>

-   一个VPC默认只能添加1个IPv4扩展网段。
-   扩展网段的子网地址与VPC路由表中已有路由的目的地址相同或者重叠，会导致已有路由不生效。

    在扩展网段中创建子网时，系统会为该子网生成一条目的地址为子网网段，下一跳为Local的路由，Local路由属于VPC内部路由，优先级高于VPC路由表中添加的其他路由。比如，VPC路由表已有某个下一跳为对等连接的路由，其目的地址为100.20.0.0/24；新增扩展网段的子网路由，其目的地址为100.20.0.0/16，100.20.0.0/16和100.20.0.0/24网段重叠，流量优先通过扩展网段子网的路由转发，会导致对等连接的路由失效。

-   不支持添加的扩展网段范围如[表1](#table1060431941314)所示。

    **表 1**  不支持添加的扩展网段范围

    <a name="table1060431941314"></a>
    <table><thead align="left"><tr id="row1960461912134"><th class="cellrowborder" valign="top" width="30.659999999999997%" id="mcps1.2.3.1.1"><p id="p460451981314"><a name="p460451981314"></a><a name="p460451981314"></a>网段类型</p>
    </th>
    <th class="cellrowborder" valign="top" width="69.34%" id="mcps1.2.3.1.2"><p id="p17604131916132"><a name="p17604131916132"></a><a name="p17604131916132"></a>不支持的网段范围</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row13400195055019"><td class="cellrowborder" valign="top" width="30.659999999999997%" headers="mcps1.2.3.1.1 "><p id="p1840095065014"><a name="p1840095065014"></a><a name="p1840095065014"></a>主网段或帐户下已存在网段</p>
    </td>
    <td class="cellrowborder" valign="top" width="69.34%" headers="mcps1.2.3.1.2 "><a name="ul339491375113"></a><a name="ul339491375113"></a><ul id="ul339491375113"><li>10.0.0.0/8</li><li>172.16.0.0/12</li><li>192.168.0.0/16</li></ul>
    </td>
    </tr>
    <tr id="row1760415199134"><td class="cellrowborder" valign="top" width="30.659999999999997%" headers="mcps1.2.3.1.1 "><p id="p14604819171318"><a name="p14604819171318"></a><a name="p14604819171318"></a>系统内部预留地址</p>
    </td>
    <td class="cellrowborder" valign="top" width="69.34%" headers="mcps1.2.3.1.2 "><a name="ul2862133944018"></a><a name="ul2862133944018"></a><ul id="ul2862133944018"><li>100.64.0.0/10</li><li>214.0.0.0/7</li><li>198.18.0.0/15</li><li>169.254.0.0/16</li></ul>
    </td>
    </tr>
    <tr id="row14345244391"><td class="cellrowborder" valign="top" width="30.659999999999997%" headers="mcps1.2.3.1.1 "><p id="p33442403913"><a name="p33442403913"></a><a name="p33442403913"></a>公网保留地址</p>
    </td>
    <td class="cellrowborder" valign="top" width="69.34%" headers="mcps1.2.3.1.2 "><a name="ul1322264184914"></a><a name="ul1322264184914"></a><ul id="ul1322264184914"><li>0.0.0.0/8</li><li>127.0.0.0/8</li><li>240.0.0.0/4</li><li>255.255.255.255/32</li></ul>
    </td>
    </tr>
    </tbody>
    </table>


## 操作步骤<a name="zh-cn_topic_0286956167_section2390192084013"></a>

1.  登录管理控制台。

1.  在管理控制台左上角单击![](figures/icon-region-0.png)，选择区域和项目。
2.  在系统首页，选择“网络 \> 虚拟私有云”。

    为了提升您的使用体验，虚拟私有云推出新版控制台，如果您需要体验，请根据以下指导进行操作：

    -   新版控制台：
        1.  在左侧导航栏，单击左下角的“体验新版”，打开新版控制台。

            进入“我的VPC”页面。

    -   旧版控制台：
        1.  在左侧导航栏，选择“虚拟私有云”。

            进入“虚拟私有云”页面。


3.  在虚拟私有云列表中待修改的虚拟私有云所在行的“操作”列下单击“修改”或“编辑网段”。
4.  在“编辑网段”页面，单击“添加IPv4扩展网段”。

    **图 1**  添加IPv4扩展网段<a name="zh-cn_topic_0286956167_fig696313313478"></a>  
    ![](figures/添加IPv4扩展网段.png "添加IPv4扩展网段")

5.  输入扩展网段，单击“确定”。

